%!TEX root = ../../Master.tex
\section{A* in a multistory building complex}

\subsection{Reasoning Behind the use of A*}
The Dijkstra algorithm always finds the shortest route between two positions. But because Dijkstra always calculates every possible path until it gets to the desired destination, a lot of calculations are necessary. If some of these calculations could be avoided, the runtime would be lowered which would suite the usage requirement\cref{irm_tid}. By using A*, the amount of calculations can be reduced because of the logic the algorithm uses, when admissible values are applied correctly.

\subsection{Multiple Layer Handling through FLAWLESS} \label{multlayhan}

When using A* to find a path, the use of a euclidean heuristic becomes problematic when traversing multiple floors in a building. Figure \ref{fig:buildingAstar} helps illustrate this. If a euclidean heuristic is used, the algorithm will, whenever it enters a new floor, move towards the vertex (b) that is directly below the desired goal (a), regardless of whether it is an exit vertex or not. See \cref{e_vertex}. After this point has been reached, the A* algorithm will expand the search from this vertex. This will immensely decrease the usefulness of the euclidean heuristic, to a point where the A* might no longer preferable to Dijkstra's algorithm. Because a low runtime is required for the solution, a better way of traversing floors must be employed.

\begin{figure}[ht!]
    \centering
    \includegraphics[width=0.5\textwidth]{buildingastar_paint}
    \caption{How many vertices the A* algorithm would expand, if using the euclidean distance as heuristic}
    \label{fig:buildingAstar}
  \end{figure}

The solution to this problem lies in a tripartitioning of the pathfinding process, and is illustrated in figure \ref{precomp}. Using the fact that the optimal route from one exit vertex to any other exit vertex is static, and only the choice of exit vertices varies when finding the optimal route between the initial and final floor, the paths from exit vertex to exit vertex can be precomputed. By computing and storing these routes when initializing the program, the response time when prompted for a path, will be lowered significantly.

When using this approach, the runtime will consist of a round of A* runs done on both the initial floor and the destination floor. These runs are done from the start vertex and the destination vertex to all exit vertices on their respective floors. When this has been computed, all the possible combinations of paths will have their individual evaluation values added, and a comparison between the total evaluation values will determine the optimal path across the multiple floors. 

This method of handing multiple floors in a building is named fused locale A* with level-calculation executed at system startup, and shortened to FLAWLESS. 

\kanote{skriv hvordan vi precomputer med Dijkstra}

\begin{figure}[ht!]
    \centering
    \includegraphics[width=0.5\textwidth]{precomputedpath}
    \caption{mangler billedtekst}
    \label{fig:precomp}
  \end{figure}

\kanote{mangler billedtekst}

\subsection{Choosing Stairs or the Elevator}

When the algorithm stands between choosing the stairs, or an elevator when traveling to another floor, the choice is determined by the weight of the route. The weight is based on how time consuming or psychical fatiguing the process is for the user. In order to weight the vertex in a way that reflects reality the stairs weight should grow exponentially. The more stairs a user climbs in succession the more psychical fatiguing it gets which is the reasoning for the exponential growth. This have however been delimited 
\annote{indst smart reference til afgrnsing her}
 and both the stairs and elevator will therefore be weighted in a linear manner. The figure \cref{labeled_stairsVSelevators} shows a graph with the stairs and elevator. The elevator starts with more initial weight as it takes time to enter the elevator and select a floor to go to, where the stairs start ascending as soon the user is on the first step. But once the user is inside the elevator, and it starts ascending, it will catch on the stairs and eventually become the fastest way of traveling. On the graph, the point were the elevator is faster than the stairs, is were the two lines cross, which in this case is between the fourth and third floor. This means if the user has to travel four or more floors, the planned route should utilize the elevator.

\begin{figure}[ht!]
    \centering
    \includegraphics[width=0.5\textwidth]{stairsVSelevators.png}
    \label{fig:labeled_stairsVSelevators}
  \end{figure}

  \annote{Kapitler er ikke færdigt da det mangler at blive gennemlst, rettet og gennemtænkt. Dett er version 0.8}

In Stakeholders user, are different people have been described each with their own characteristics, and some people don't have the opportunity to take the elevators or the stairs, to resolve this problem are the weight of a stair or an elevator multiplied with an extremely high number, when the search algorithm travels through the graph then it wont consider e.g. the stairs if the user selected that they would not take the stairs, the same with the elevator. Another way of resolving the problem is to stop the algorithm from considering the stairs by disabling it, if the user choses not to take the stairs, this will make it unusable for the algorithm. A problem with this is if the only way up, is by stairs and the user did selected not to take the stairs, then the program with exit with an error, but if the weight is multiplied with a number, then the search algorithm will take the stairs as an last resort. If the project was to deliver an final product, the program will still show the user the determined route, but prompt the user with a warning.



